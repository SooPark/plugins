<!-- trunk-ignore(markdownlint/MD041) -->
<p align="center">
  <a href="https://docs.trunk.io">
    <img height="128" src="https://static.trunk.io/assets/vscode_icon.png" />
  </a>
</p>
<h2 align="center">Trunk</h2>
<p align="center">
  <a href="https://npmcharts.com/compare/@trunkio/launcher?minimal=true">
    <img src="https://img.shields.io/npm/dm/@trunkio/launcher.svg">
  </a>
  <a href="https://marketplace.visualstudio.com/items?itemName=Trunk.io">
    <img src="https://img.shields.io/visual-studio-marketplace/i/Trunk.io?logo=visualstudiocode"/>
  </a>
  <a href="https://slack.trunk.io">
    <img src="https://img.shields.io/badge/slack-slack.trunk.io-blue?logo=slack"/>
  </a>
  <a href="https://docs.trunk.io">
    <img src="https://img.shields.io/badge/docs.trunk.io-7f7fcc?label=docs&logo=readthedocs&labelColor=555555&logoColor=ffffff"/>
  </a>
</p>

> üéâ Trunk is in beta. We'd appreciate your feedback - stop by the
> [Trunk Community Slack](https://slack.trunk.io/) and let us know what you think. Thanks!

Trunk is a blazingly fast meta code checker and formatter with extraordinary features like caching,
preexisting issue detection, a daemon, and a language server. It's managed completely via
config-as-code, so you can easily pin your repo to specific versions of your linters, formatters,
and static analyzers.

Don't install a dozen different linter and formatting plugins, just use Trunk. Level up your code
quality and consistency today.

## Get Started

1. Install Trunk ‚Üí `npm install trunk` ([docs](https://docs.trunk.io/get-started))
1. Setup Trunk in your repo ‚Üí `trunk init` ([docs](https://docs.trunk.io/get-started))
1. Take Trunk for a spin ‚Üí `trunk check --sample`

That's it!

## Linters / Formatters

We integrate new linters every release. Stop by on [slack](https://slack.trunk.io/) and let us know
what you'd like next!

| Language        | Linters                                                                       |
| --------------- | ----------------------------------------------------------------------------- |
| All             | `gitleaks`                                                                    |
| Ansible         | `ansible-lint`                                                                |
| Bash            | `shellcheck`, `shfmt`                                                         |
| Bazel, Starlark | `buildifier`                                                                  |
| C/C++           | `clang-format`, `clang-tidy`                                                  |
| Cloudformation  | `cfnlint`                                                                     |
| Docker          | `hadolint`                                                                    |
| GitHub          | `actionlint`                                                                  |
| Go              | `gofmt`, `golangci-lint`, `semgrep`                                           |
| HAML            | `haml-lint`                                                                   |
| Java            | `semgrep`                                                                     |
| JS/TS           | `eslint`, `prettier`, `semgrep`                                               |
| Kotlin          | `detekt`, `detekt-explicit`, `ktlint`                                         |
| Markdown        | `markdownlint`                                                                |
| Protobuf        | `buf-breaking`, `buf-lint`                                                    |
| Python          | `autopep8`, `bandit`, `black`, `flake8`, `isort`, `pylint`, `semgrep`, `yapf` |
| Ruby            | `brakeman`, `rubocop`, `rufo`, `semgrep`, `standardrb`                        |
| Rust            | `clippy`, `rustfmt`                                                           |
| Terraform       | `terraform-fmt`, `terraform-validate`, `tflint`                               |
| TOML            | `taplo`                                                                       |

## How it works

Trunk downloads everything it needs to run on demand and caches it in `~/.cache/trunk`.

## Linting and formatting principles

- Autoformat every file. _Every_ file.
- Every file in your repo should have at least one tool checking its validity
- You should always get the same results locally as on CI

## Features

### Initialization

Trunk manages all configuration as code in your repo's `.trunk/trunk.yaml` file. When you first
`trunk init`, we scan your repo for which linters and formatters are applicable to you and set up an
initial `.trunk/trunk.yaml` file for you to use. See the [docs](https://docs.trunk.io/check/config)
for more details.

### Formatting

#### Don't install 15 formatters, just use trunk

Ever hit one of these problems?

- Struggling to figure out why you need a Go or Ruby installation to run a specific formatter
- Devs on your team all get slightly different formatting results because you're running different
  versions of the formatters
- Your formatting doesn't match what your CI lint job is expecting because you're running a
  different version of a formatter locally

That's what formatting via Trunk solves. Everyone on your team is guaranteed to get the same
results, because we always run the same version of each formatter/linter on everyone's machine,
including in your CI lint job.

### Ignoring Issues

Trunk supports a special syntax to ignore issues from any linter. See the "Suppressing Issues"
section below for the syntax of `trunk-ignore` comments.

## Extras: VSCode Extension & GitHub Action

1. Use a single extension for all your linting and formatting ‚Üí
   [Trunk VSCode Extension](https://marketplace.visualstudio.com/items?itemName=Trunk.io)
1. Protect lint and format issues from leaking into main ‚Üí
   [Trunk GitHub Action](https://github.com/marketplace/actions/trunk-check)

## Prereqs

None! Trunk manages linters and formatters for you via pinned versions in your repo's
`.trunk/trunk.yaml` file. You don't need to install any linters or configure the extension in any
way. We cache linters, formatters, and runtimes in `~/.cache/trunk`. Using a linter distributed as a
go module but you're not a go user? Don't worry about it, we handle it all üòâ.

## How versioning works

After you `trunk init`, `trunk.yaml` will contain a pinned version of Trunk to use for your repo.
When you run trunk, it will automatically detect which version you should be running for a
particular repo and, if needed, download it, then run it. The trunk VSCode extension works the same
way: regardless of what repo you're in, the underlying version of trunk it runs is based on the
pinned version in your `trunk.yaml` file. Config-as-code üëç.

This means that **everyone working in a repo, using the `trunk` cli, the VSCode extension, or when
running on CI, all get the same results** because they're running the same version of trunk and the
same versions of all the linters/formatters. No more "doesn't happen on my machine". When you want
to upgrade to a newer version, just run `trunk upgrade` and commit the updated `trunk.yaml`.

## Suppressing Issues

Sometimes we want to deliberately tell a linter that, yes, I know what I'm doing, and yes, in any
other situation I should _not_ do this, but in this specific case it's fine. Maybe there's a
stand-in private key you're using for a test stack, or fixing the lint issue will actually make your
code less readable: whatever it is, you now need to figure out how to suppress a given lint issue.

`trunk` provides a simple, standardized mechanism to do this, saving you from having to look up the
linter-specific syntax for doing so:

```cpp {3}
struct FooBar {
  // trunk-ignore(clang-tidy/modernize-use-nullptr): this is a load-bearing NULL, see ISSUE-832
  void *ptr = NULL;
};
```

This tells `trunk` that the `clang-tidy` linter found a `modernize-use-nullptr` issue on the
highlighted line and that `trunk` should suppress this linter issue.

Comments are obviously not required:

```cpp {3}
struct FooBar {
  // trunk-ignore(clang-tidy/modernize-use-nullptr)
  void *ptr = NULL;
};
```

You can also omit the name of the check to simply tell `trunk` that all issues from a given linter
on a specific line should be suppressed:

```cpp {3}
struct FooBar {
  // trunk-ignore(clang-tidy)
  void *ptr = NULL;
};
```

`trunk-ignore` directives can also be placed at the end of the line on which they're suppressing
lint issues:

```cpp {2-3}
struct FooBar {
  void *ptr1 = NULL;  // trunk-ignore(clang-tidy/modernize-use-nullptr)
  void *ptr2 = NULL;  // trunk-ignore(clang-tidy)
};
```

If you need to suppress issues from multiple linters, `trunk-ignore` supports that too:

```cpp {4}
struct FooBar {
  // trunk-ignore(clang-tidy): ISSUE-914 explains why the `void *` type is needed
  // trunk-ignore(gitleaks,my-custom-linter/do-not-hardcode-passwords): see ISSUE-915
  void *super_secret_password = (void *)("915dr~S$Pzqod~oR*CrQ$/SQ@hbtQBked:CL@z!y]");
};
```

Supressing all issues in a file:

```cpp {2-5}
// trunk-ignore-all(clang-tidy)
struct FooBar {
  void *ptr1 = NULL;
  void *ptr2 = NULL;
};
```

Supressing all issues in block of code:

```cpp {3-4}
struct FooBar {
  // trunk-ignore-begin(clang-tidy)
  void *ptr1 = NULL;
  void *ptr2 = NULL;
  // trunk-ignore-end(clang-tidy)
};
```

Notice that a `trunk-ignore` directive applies not to the next line, but the next non-`trunk-ignore`
line (this only works for _preceding_ directives, not _trailing_ directives), and that you can use a
single directive for suppressing multiple checks.

### Specification

The syntax of a trunk-ignore directive is as follows:

```text
<trunk-ignore>      ::= "trunk-ignore(" <check-ids> ")" <optional-comment>
<check-ids>         ::= <check-id> <optional-check-id>
<optional-check-id> ::= "," <check-id>
<check-id>          ::= <linter-id> <optional-rule-id>
<optional-rule-id>  ::= "/" <rule-id>
<optional-comment>  ::= ": " <comment>
```

## Development Status

Trunk is currently in beta. We typically release new versions every other week. Expect some bumps
along the way, but give us lots of feedback, and we'll address your bugs and feature requests
swiftly.

For support and feedback, reach out on your company's Trunk slack connect channel, or our
[Trunk Community slack](https://slack.trunk.io). Thanks!

## Feedback

Join the [Trunk Community Slack](https://slack.trunk.io/). ‚ù§Ô∏è
